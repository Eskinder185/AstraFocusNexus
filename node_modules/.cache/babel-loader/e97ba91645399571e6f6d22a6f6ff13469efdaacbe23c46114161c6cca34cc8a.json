{"ast":null,"code":"import _objectSpread from\"C:/Users/eskew/github/tasktracker/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useMemo,useRef,useState}from\"react\";import BreakSuggestions from\"./BreakSuggestions\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DEFAULTS={focusMin:25,shortMin:5,longMin:15,cyclesBeforeLong:4,autoStartNext:true};function format(ms){const s=Math.max(0,Math.round(ms/1000));const m=Math.floor(s/60);const r=s%60;return\"\".concat(String(m).padStart(2,\"0\"),\":\").concat(String(r).padStart(2,\"0\"));}/** Try web notification; returns true if a notification was shown */async function tryNotify(title,body){if(!(\"Notification\"in window))return false;// If user hasn't decided yet, politely ask\nif(Notification.permission===\"default\"){try{await Notification.requestPermission();}catch(_unused){}}if(Notification.permission===\"granted\"){try{new Notification(title,{body,tag:\"pomodoro\"});return true;}catch(_unused2){}}return false;}// --- Secondary alert methods (work even if notifications are blocked) ---\nfunction playChime(audioRef){const a=audioRef.current;if(a){a.currentTime=0;a.volume=1;a.play().catch(()=>{// fallback: simple beep\ntry{const Ctx=window.AudioContext||window.webkitAudioContext;const ctx=new Ctx();const osc=ctx.createOscillator();const gain=ctx.createGain();osc.type=\"sine\";osc.frequency.value=880;osc.connect(gain);gain.connect(ctx.destination);gain.gain.setValueAtTime(0.001,ctx.currentTime);gain.gain.exponentialRampToValueAtTime(0.6,ctx.currentTime+0.03);osc.start();setTimeout(()=>{gain.gain.exponentialRampToValueAtTime(0.0001,ctx.currentTime+0.25);osc.stop(ctx.currentTime+0.27);},230);}catch(_unused3){}});}}function vibrate(){if(\"vibrate\"in navigator){try{navigator.vibrate([200,100,200]);}catch(_unused4){}}}// Clean title flasher (uses clear emoji and avoids encoding artifacts)\nfunction startTitleFlash(store,handle){if(handle.current)return;store.current=document.title;let on=false;handle.current=window.setInterval(()=>{on=!on;document.title=on?\"‚è∞ Pomodoro done!\":store.current;},800);}function flashTitleStop(store,handle){if(handle.current){window.clearInterval(handle.current);handle.current=null;document.title=store.current||document.title;}}const PomodoroTimer=_ref=>{let{activeTaskTitle,onFocusComplete,onRunningChange}=_ref;const[settings,setSettings]=useState(()=>{try{const raw=localStorage.getItem(\"pomodoro.settings\");return raw?_objectSpread(_objectSpread({},DEFAULTS),JSON.parse(raw)):DEFAULTS;}catch(_unused5){return DEFAULTS;}});// session state\nconst[mode,setMode]=useState(\"focus\");const[running,setRunning]=useState(false);const[endAt,setEndAt]=useState(null);const[remaining,setRemaining]=useState(settings.focusMin*60000);const[cycle,setCycle]=useState(0);// completed focus sessions in current block\nconst[showBreakModal,setShowBreakModal]=useState(false);const[modalClosing,setModalClosing]=useState(false);const nextModeRef=useRef(\"short\");const nextDurRef=useRef(settings.shortMin*60000);// permission/bell state\nconst[perm,setPerm]=useState(\"default\");// refs for secondary alerts\nconst audioRef=useRef(null);const originalTitleRef=useRef(document.title);const flasherRef=useRef(null);// persist settings\nuseEffect(()=>{localStorage.setItem(\"pomodoro.settings\",JSON.stringify(settings));},[settings]);// init notification permission + tiny inline chime\nuseEffect(()=>{if(!(\"Notification\"in window))setPerm(\"unsupported\");else setPerm(Notification.permission);// tiny inline WAV so it works offline (attach to the existing <audio>)\ntry{if(audioRef.current){audioRef.current.src=\"data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAAAACAAAAPGZmZmZmZmZm\";}}catch(_unused6){}},[]);// compute target duration for current mode\nconst durationMs=useMemo(()=>{if(mode===\"focus\")return settings.focusMin*60000;if(mode===\"short\")return settings.shortMin*60000;return settings.longMin*60000;},[mode,settings]);// keep remaining in sync when mode/duration changes (if not running)\nuseEffect(()=>{if(!running)setRemaining(durationMs);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[durationMs]);// main ticker\nuseEffect(()=>{if(!running||endAt==null)return;const id=window.setInterval(()=>{const now=Date.now();const left=endAt-now;setRemaining(left);if(left<=0){window.clearInterval(id);setRunning(false);setRemaining(0);// session complete\n(async()=>{if(mode===\"focus\"){// 1) Web notification (if allowed)\nconst title=\"Focus complete ‚úÖ\";const body=activeTaskTitle?\"Task: \".concat(activeTaskTitle):\"Take a break!\";await tryNotify(title,body);// 2) Secondary alerts (always try)\nplayChime(audioRef);vibrate();startTitleFlash(originalTitleRef,flasherRef);// auto stop flashing after 20s\nwindow.setTimeout(()=>flashTitleStop(originalTitleRef,flasherRef),20000);// callback to parent\nonFocusComplete===null||onFocusComplete===void 0?void 0:onFocusComplete();// choose next mode\nconst nextMode=(cycle+1)%settings.cyclesBeforeLong===0?\"long\":\"short\";setCycle(c=>c+1);setMode(nextMode);// prepare next session but pause for suggestions\nconst nextDur=(nextMode===\"long\"?settings.longMin:settings.shortMin)*60000;setRemaining(nextDur);nextModeRef.current=nextMode;nextDurRef.current=nextDur;setModalClosing(false);setShowBreakModal(true);}else{// Break finished\nconst title=mode===\"short\"?\"Short break over ‚òï\":\"Long break over üåø\";await tryNotify(title,\"Time to focus again!\");playChime(audioRef);vibrate();startTitleFlash(originalTitleRef,flasherRef);window.setTimeout(()=>flashTitleStop(originalTitleRef,flasherRef),20000);setMode(\"focus\");const nextDur=settings.focusMin*60000;setRemaining(nextDur);if(settings.autoStartNext)start(nextDur);}})();}},250);return()=>window.clearInterval(id);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[running,endAt,mode,settings,cycle,activeTaskTitle]);const start=dur=>{// If user hasn't made a choice yet, ask once they start\nif(\"Notification\"in window&&Notification.permission===\"default\"){Notification.requestPermission().then(p=>setPerm(p));}flashTitleStop(originalTitleRef,flasherRef);// clear any previous flashing\nconst resumeMs=typeof dur==='number'?dur:Math.max(0,remaining);const nextMs=resumeMs>0?resumeMs:durationMs;setEndAt(Date.now()+nextMs);setRunning(true);onRunningChange===null||onRunningChange===void 0?void 0:onRunningChange(true);// Fire a start notification (best-effort so users get an immediate cue)\ntryNotify(mode===\"focus\"?\"Focus started\":mode===\"short\"?\"Short break started\":\"Long break started\",activeTaskTitle?\"Task: \".concat(activeTaskTitle):\"\");};const pause=()=>setRunning(false);useEffect(()=>{onRunningChange===null||onRunningChange===void 0?void 0:onRunningChange(running);},[running,onRunningChange]);const reset=()=>{setRunning(false);setEndAt(null);setRemaining(durationMs);flashTitleStop(originalTitleRef,flasherRef);onRunningChange===null||onRunningChange===void 0?void 0:onRunningChange(false);};const skip=()=>{// force-complete current mode\nsetRunning(false);setRemaining(0);flashTitleStop(originalTitleRef,flasherRef);if(mode===\"focus\"){setCycle(c=>c+1);onFocusComplete===null||onFocusComplete===void 0?void 0:onFocusComplete();const next=(cycle+1)%settings.cyclesBeforeLong===0?\"long\":\"short\";setMode(next);}else{setMode(\"focus\");}setTimeout(()=>{if(settings.autoStartNext)start();else reset();},0);};const requestPermission=async()=>{if(!(\"Notification\"in window))return alert(\"Notifications not supported.\");if(Notification.permission===\"denied\"){setPerm(\"denied\");alert([\"Notifications are blocked for this site.\",\"To enable: click the lock icon in the address bar ‚Üí Site settings ‚Üí Notifications ‚Üí Allow.\"].join(\"\\n\"));return;}try{const res=await Notification.requestPermission();setPerm(res);if(res!==\"granted\")alert(\"Notifications denied.\");else{// Show a quick test notification so the user can confirm it works\nawait tryNotify(\"Notifications enabled\",\"You'll get alerts at start and end.\");}}catch(_unused7){alert(\"Could not request notifications.\");}};return/*#__PURE__*/_jsxs(\"div\",{className:\"pomodoro\",children:[/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,style:{display:\"none\"}}),/*#__PURE__*/_jsxs(\"div\",{className:\"pomodoro__head\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pomodoro__modes\",children:[\"focus\",\"short\",\"long\"].map(m=>/*#__PURE__*/_jsx(\"button\",{className:\"pill \".concat(mode===m?\"active\":\"\"),onClick:()=>{setMode(m);setRunning(false);setEndAt(null);flashTitleStop(originalTitleRef,flasherRef);},children:m===\"focus\"?\"Focus\":m===\"short\"?\"Short\":\"Long\"},m))}),/*#__PURE__*/_jsx(\"button\",{className:\"pill\",onClick:requestPermission,title:\"Enable notifications\",disabled:perm===\"unsupported\",children:perm===\"granted\"?\"üîî\":\"üîï\"})]}),activeTaskTitle&&/*#__PURE__*/_jsxs(\"div\",{className:\"pomodoro__task\",title:\"Active task\",children:[\"\\uD83C\\uDFAF \",activeTaskTitle]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pomodoro__timer\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"pomo-ring\",width:\"120\",height:\"120\",viewBox:\"0 0 120 120\",\"aria-hidden\":true,children:(()=>{const r=52;const cx=60;const cy=60;const c=2*Math.PI*r;const denom=Math.max(1,durationMs);const frac=Math.max(0,Math.min(1,remaining/denom));const off=c*frac;return/*#__PURE__*/_jsxs(\"g\",{children:[/*#__PURE__*/_jsx(\"circle\",{className:\"ring-bg\",cx:cx,cy:cy,r:r}),/*#__PURE__*/_jsx(\"circle\",{className:\"ring-fg\",cx:cx,cy:cy,r:r,style:{strokeDasharray:\"\".concat(c,\"px\"),strokeDashoffset:\"\".concat(off,\"px\")}})]});})()}),/*#__PURE__*/_jsx(\"div\",{className:\"pomo-time\",children:format(remaining)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pomodoro__controls\",children:[!running?/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:()=>start(),children:\"Start\"}):/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:pause,children:\"Pause\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:reset,children:\"Reset\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:skip,children:\"Skip\"})]}),/*#__PURE__*/_jsxs(\"details\",{className:\"pomodoro__settings\",children:[/*#__PURE__*/_jsx(\"summary\",{children:\"Settings\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid2\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Focus (min)\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,value:settings.focusMin,onChange:e=>setSettings(s=>_objectSpread(_objectSpread({},s),{},{focusMin:+e.target.value||1}))})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Short break (min)\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,value:settings.shortMin,onChange:e=>setSettings(s=>_objectSpread(_objectSpread({},s),{},{shortMin:+e.target.value||1}))})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Long break (min)\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,value:settings.longMin,onChange:e=>setSettings(s=>_objectSpread(_objectSpread({},s),{},{longMin:+e.target.value||1}))})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Cycles before long\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,value:settings.cyclesBeforeLong,onChange:e=>setSettings(s=>_objectSpread(_objectSpread({},s),{},{cyclesBeforeLong:Math.max(1,+e.target.value||1)}))})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"rowFlex\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:settings.autoStartNext,onChange:e=>setSettings(s=>_objectSpread(_objectSpread({},s),{},{autoStartNext:e.target.checked}))}),\"Auto-start next\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"muted\",children:[\"Completed in block: \",cycle]})]})]}),showBreakModal&&/*#__PURE__*/_jsx(BreakSuggestions,{closing:modalClosing,onStartBreak:()=>{setModalClosing(true);setTimeout(()=>{setShowBreakModal(false);setModalClosing(false);// start the prepared break\nsetMode(nextModeRef.current);start(nextDurRef.current);},180);},onSkipBreak:()=>{setModalClosing(true);setTimeout(()=>{setShowBreakModal(false);setModalClosing(false);// jump to next focus session immediately\nconst dur=settings.focusMin*60000;setMode(\"focus\");setRemaining(dur);start(dur);},180);}})]});};export default PomodoroTimer;","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","BreakSuggestions","jsx","_jsx","jsxs","_jsxs","DEFAULTS","focusMin","shortMin","longMin","cyclesBeforeLong","autoStartNext","format","ms","s","Math","max","round","m","floor","r","concat","String","padStart","tryNotify","title","body","window","Notification","permission","requestPermission","_unused","tag","_unused2","playChime","audioRef","a","current","currentTime","volume","play","catch","Ctx","AudioContext","webkitAudioContext","ctx","osc","createOscillator","gain","createGain","type","frequency","value","connect","destination","setValueAtTime","exponentialRampToValueAtTime","start","setTimeout","stop","_unused3","vibrate","navigator","_unused4","startTitleFlash","store","handle","document","on","setInterval","flashTitleStop","clearInterval","PomodoroTimer","_ref","activeTaskTitle","onFocusComplete","onRunningChange","settings","setSettings","raw","localStorage","getItem","_objectSpread","JSON","parse","_unused5","mode","setMode","running","setRunning","endAt","setEndAt","remaining","setRemaining","cycle","setCycle","showBreakModal","setShowBreakModal","modalClosing","setModalClosing","nextModeRef","nextDurRef","perm","setPerm","originalTitleRef","flasherRef","setItem","stringify","src","_unused6","durationMs","id","now","Date","left","nextMode","c","nextDur","dur","then","p","resumeMs","nextMs","pause","reset","skip","next","alert","join","res","_unused7","className","children","ref","style","display","map","onClick","disabled","width","height","viewBox","cx","cy","PI","denom","frac","min","off","strokeDasharray","strokeDashoffset","onChange","e","target","checked","closing","onStartBreak","onSkipBreak"],"sources":["C:/Users/eskew/github/tasktracker/src/PomodoroTimer.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport BreakSuggestions from \"./BreakSuggestions\";\n\r\ntype Mode = \"focus\" | \"short\" | \"long\";\r\n\r\nexport interface PomodoroSettings {\r\n  focusMin: number;\r\n  shortMin: number;\r\n  longMin: number;\r\n  cyclesBeforeLong: number;\r\n  autoStartNext: boolean;\r\n}\r\n\r\nconst DEFAULTS: PomodoroSettings = {\r\n  focusMin: 25,\r\n  shortMin: 5,\r\n  longMin: 15,\r\n  cyclesBeforeLong: 4,\r\n  autoStartNext: true,\r\n};\r\n\r\nfunction format(ms: number) {\r\n  const s = Math.max(0, Math.round(ms / 1000));\r\n  const m = Math.floor(s / 60);\r\n  const r = s % 60;\r\n  return `${String(m).padStart(2, \"0\")}:${String(r).padStart(2, \"0\")}`;\r\n}\r\n\r\n/** Try web notification; returns true if a notification was shown */\r\nasync function tryNotify(title: string, body: string) {\r\n  if (!(\"Notification\" in window)) return false;\r\n  // If user hasn't decided yet, politely ask\r\n  if (Notification.permission === \"default\") {\r\n    try { await Notification.requestPermission(); } catch {}\r\n  }\r\n  if (Notification.permission === \"granted\") {\n    try { new Notification(title, { body, tag: \"pomodoro\" }); return true; } catch {}\n  }\n  return false;\r\n}\r\n\r\n// --- Secondary alert methods (work even if notifications are blocked) ---\r\nfunction playChime(audioRef: React.MutableRefObject<HTMLAudioElement | null>) {\r\n  const a = audioRef.current;\r\n  if (a) {\r\n    a.currentTime = 0;\r\n    a.volume = 1;\r\n    a.play().catch(() => {\r\n      // fallback: simple beep\r\n      try {\r\n        const Ctx = (window as any).AudioContext || (window as any).webkitAudioContext;\r\n        const ctx = new Ctx();\r\n        const osc = ctx.createOscillator();\r\n        const gain = ctx.createGain();\r\n        osc.type = \"sine\"; osc.frequency.value = 880;\r\n        osc.connect(gain); gain.connect(ctx.destination);\r\n        gain.gain.setValueAtTime(0.001, ctx.currentTime);\r\n        gain.gain.exponentialRampToValueAtTime(0.6, ctx.currentTime + 0.03);\r\n        osc.start();\r\n        setTimeout(() => {\r\n          gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.25);\r\n          osc.stop(ctx.currentTime + 0.27);\r\n        }, 230);\r\n      } catch {}\r\n    });\r\n  }\r\n}\r\nfunction vibrate() {\n  if (\"vibrate\" in navigator) {\n    try { navigator.vibrate([200, 100, 200]); } catch {}\n  }\n}\n// Clean title flasher (uses clear emoji and avoids encoding artifacts)\nfunction startTitleFlash(store: React.MutableRefObject<string>, handle: React.MutableRefObject<number | null>) {\n  if (handle.current) return;\n  store.current = document.title;\n  let on = false;\n  handle.current = window.setInterval(() => {\n    on = !on;\n    document.title = on ? \"‚è∞ Pomodoro done!\" : store.current;\n  }, 800) as unknown as number;\n}\nfunction flashTitleStop(store: React.MutableRefObject<string>, handle: React.MutableRefObject<number | null>) {\r\n  if (handle.current) {\r\n    window.clearInterval(handle.current);\r\n    handle.current = null;\r\n    document.title = store.current || document.title;\r\n  }\r\n}\r\n\r\ntype Props = {\n  activeTaskTitle?: string;\n  onFocusComplete?: () => void; // called when a focus session completes\n  onRunningChange?: (running: boolean) => void; // notify parent when running state changes\n};\n\r\nconst PomodoroTimer: React.FC<Props> = ({ activeTaskTitle, onFocusComplete, onRunningChange }) => {\n  const [settings, setSettings] = useState<PomodoroSettings>(() => {\r\n    try {\r\n      const raw = localStorage.getItem(\"pomodoro.settings\");\r\n      return raw ? { ...DEFAULTS, ...JSON.parse(raw) } : DEFAULTS;\r\n    } catch {\r\n      return DEFAULTS;\r\n    }\r\n  });\r\n\r\n  // session state\r\n  const [mode, setMode] = useState<Mode>(\"focus\");\r\n  const [running, setRunning] = useState(false);\r\n  const [endAt, setEndAt] = useState<number | null>(null);\r\n  const [remaining, setRemaining] = useState<number>(settings.focusMin * 60_000);\r\n  const [cycle, setCycle] = useState<number>(0); // completed focus sessions in current block\n  const [showBreakModal, setShowBreakModal] = useState<boolean>(false);\n  const [modalClosing, setModalClosing] = useState<boolean>(false);\n  const nextModeRef = useRef<Mode>(\"short\");\n  const nextDurRef = useRef<number>(settings.shortMin * 60_000);\n\r\n  // permission/bell state\r\n  const [perm, setPerm] = useState<NotificationPermission | \"unsupported\">(\"default\");\r\n\r\n  // refs for secondary alerts\r\n  const audioRef = useRef<HTMLAudioElement | null>(null);\r\n  const originalTitleRef = useRef<string>(document.title);\r\n  const flasherRef = useRef<number | null>(null);\r\n\r\n  // persist settings\r\n  useEffect(() => {\r\n    localStorage.setItem(\"pomodoro.settings\", JSON.stringify(settings));\r\n  }, [settings]);\r\n\r\n  // init notification permission + tiny inline chime\r\n  useEffect(() => {\r\n    if (!(\"Notification\" in window)) setPerm(\"unsupported\");\r\n    else setPerm(Notification.permission);\r\n\r\n    // tiny inline WAV so it works offline (attach to the existing <audio>)\n    try {\n      if (audioRef.current) {\n        audioRef.current.src =\n          \"data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABYAAAACAAAAPGZmZmZmZmZm\";\n      }\n    } catch {}\n  }, []);\n\r\n  // compute target duration for current mode\r\n  const durationMs = useMemo(() => {\r\n    if (mode === \"focus\") return settings.focusMin * 60_000;\r\n    if (mode === \"short\") return settings.shortMin * 60_000;\r\n    return settings.longMin * 60_000;\r\n  }, [mode, settings]);\r\n\r\n  // keep remaining in sync when mode/duration changes (if not running)\n  useEffect(() => {\n    if (!running) setRemaining(durationMs);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [durationMs]);\n\r\n  // main ticker\r\n  useEffect(() => {\r\n    if (!running || endAt == null) return;\r\n\r\n    const id = window.setInterval(() => {\r\n      const now = Date.now();\r\n      const left = endAt - now;\r\n      setRemaining(left);\r\n      if (left <= 0) {\r\n        window.clearInterval(id);\r\n        setRunning(false);\r\n        setRemaining(0);\r\n\r\n        // session complete\r\n        (async () => {\r\n          if (mode === \"focus\") {\r\n            // 1) Web notification (if allowed)\r\n            const title = \"Focus complete ‚úÖ\";\r\n            const body = activeTaskTitle ? `Task: ${activeTaskTitle}` : \"Take a break!\";\r\n            await tryNotify(title, body);\n\r\n            // 2) Secondary alerts (always try)\n            playChime(audioRef);\n            vibrate();\n            startTitleFlash(originalTitleRef, flasherRef);\n            // auto stop flashing after 20s\r\n            window.setTimeout(() => flashTitleStop(originalTitleRef, flasherRef), 20_000);\r\n\r\n            // callback to parent\r\n            onFocusComplete?.();\r\n\r\n            // choose next mode\n            const nextMode =\n              (cycle + 1) % settings.cyclesBeforeLong === 0 ? \"long\" : \"short\";\n            setCycle((c) => c + 1);\n            setMode(nextMode);\n\n            // prepare next session but pause for suggestions\n            const nextDur = (nextMode === \"long\" ? settings.longMin : settings.shortMin) * 60_000;\n            setRemaining(nextDur);\n            nextModeRef.current = nextMode;\n            nextDurRef.current = nextDur;\n            setModalClosing(false);\n            setShowBreakModal(true);\n          } else {\n            // Break finished\r\n            const title = mode === \"short\" ? \"Short break over ‚òï\" : \"Long break over üåø\";\r\n            await tryNotify(title, \"Time to focus again!\");\r\n            playChime(audioRef);\n            vibrate();\n            startTitleFlash(originalTitleRef, flasherRef);\n            window.setTimeout(() => flashTitleStop(originalTitleRef, flasherRef), 20_000);\r\n\r\n            setMode(\"focus\");\n            const nextDur = settings.focusMin * 60_000;\n            setRemaining(nextDur);\n            if (settings.autoStartNext) start(nextDur);\n          }\n        })();\n      }\n    }, 250);\r\n\r\n    return () => window.clearInterval(id);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [running, endAt, mode, settings, cycle, activeTaskTitle]);\r\n\r\n  const start = (dur?: number) => {\n    // If user hasn't made a choice yet, ask once they start\r\n    if (\"Notification\" in window && Notification.permission === \"default\") {\r\n      Notification.requestPermission().then((p) => setPerm(p));\r\n    }\r\n    flashTitleStop(originalTitleRef, flasherRef); // clear any previous flashing\n    const resumeMs = (typeof dur === 'number' ? dur : Math.max(0, remaining));\n    const nextMs = resumeMs > 0 ? resumeMs : durationMs;\n    setEndAt(Date.now() + nextMs);\n    setRunning(true);\n    onRunningChange?.(true);\n    // Fire a start notification (best-effort so users get an immediate cue)\n    tryNotify(\n      mode === \"focus\" ? \"Focus started\" : mode === \"short\" ? \"Short break started\" : \"Long break started\",\n      activeTaskTitle ? `Task: ${activeTaskTitle}` : \"\"\n    );\n  };\n  const pause = () => setRunning(false);\n  useEffect(() => { onRunningChange?.(running); }, [running, onRunningChange]);\n  const reset = () => {\n    setRunning(false);\n    setEndAt(null);\n    setRemaining(durationMs);\n    flashTitleStop(originalTitleRef, flasherRef);\n    onRunningChange?.(false);\n  };\n  const skip = () => {\r\n    // force-complete current mode\r\n    setRunning(false);\r\n    setRemaining(0);\r\n    flashTitleStop(originalTitleRef, flasherRef);\r\n\r\n    if (mode === \"focus\") {\r\n      setCycle((c) => c + 1);\r\n      onFocusComplete?.();\r\n      const next = (cycle + 1) % settings.cyclesBeforeLong === 0 ? \"long\" : \"short\";\r\n      setMode(next);\r\n    } else {\r\n      setMode(\"focus\");\r\n    }\r\n    setTimeout(() => {\r\n      if (settings.autoStartNext) start();\r\n      else reset();\r\n    }, 0);\r\n  };\r\n\r\n  const requestPermission = async () => {\n    if (!(\"Notification\" in window)) return alert(\"Notifications not supported.\");\n    if (Notification.permission === \"denied\") {\n      setPerm(\"denied\");\n      alert(\n        [\n          \"Notifications are blocked for this site.\",\n          \"To enable: click the lock icon in the address bar ‚Üí Site settings ‚Üí Notifications ‚Üí Allow.\",\n        ].join(\"\\n\")\n      );\n      return;\n    }\n    try {\n      const res = await Notification.requestPermission();\n      setPerm(res);\n      if (res !== \"granted\") alert(\"Notifications denied.\");\n      else {\n        // Show a quick test notification so the user can confirm it works\n        await tryNotify(\"Notifications enabled\", \"You'll get alerts at start and end.\");\n      }\n    } catch {\n      alert(\"Could not request notifications.\");\n    }\n  };\n\r\n  return (\n    <div className=\"pomodoro\">\n      {/* hidden audio for chime */}\r\n      <audio ref={audioRef} style={{ display: \"none\" }} />\r\n\r\n      <div className=\"pomodoro__head\">\r\n        <div className=\"pomodoro__modes\">\r\n          {([\"focus\", \"short\", \"long\"] as Mode[]).map((m) => (\r\n            <button\r\n              key={m}\r\n              className={`pill ${mode === m ? \"active\" : \"\"}`}\r\n              onClick={() => {\r\n                setMode(m);\r\n                setRunning(false);\r\n                setEndAt(null);\r\n                flashTitleStop(originalTitleRef, flasherRef);\r\n              }}\r\n            >\r\n              {m === \"focus\" ? \"Focus\" : m === \"short\" ? \"Short\" : \"Long\"}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Bell shows state: üîï (not granted) / üîî (granted) */}\r\n        <button className=\"pill\" onClick={requestPermission} title=\"Enable notifications\" disabled={perm === \"unsupported\"}>\n          {perm === \"granted\" ? \"üîî\" : \"üîï\"}\r\n        </button>\r\n      </div>\r\n\r\n      {activeTaskTitle && (\r\n        <div className=\"pomodoro__task\" title=\"Active task\">\r\n          üéØ {activeTaskTitle}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"pomodoro__timer\">\n        <svg className=\"pomo-ring\" width=\"120\" height=\"120\" viewBox=\"0 0 120 120\" aria-hidden>\n          {(() => {\n            const r = 52; const cx = 60; const cy = 60; const c = 2 * Math.PI * r;\n            const denom = Math.max(1, durationMs);\n            const frac = Math.max(0, Math.min(1, remaining / denom));\n            const off = c * frac;\n            return (\n              <g>\n                <circle className=\"ring-bg\" cx={cx} cy={cy} r={r} />\n                <circle className=\"ring-fg\" cx={cx} cy={cy} r={r}\n                  style={{ strokeDasharray: `${c}px`, strokeDashoffset: `${off}px` }} />\n              </g>\n            );\n          })()}\n        </svg>\n        <div className=\"pomo-time\">{format(remaining)}</div>\n      </div>\n\r\n      <div className=\"pomodoro__controls\">\r\n        {!running ? (\r\n          <button className=\"btn\" onClick={() => start()}>Start</button>\r\n        ) : (\r\n          <button className=\"btn\" onClick={pause}>Pause</button>\r\n        )}\r\n        <button className=\"btn\" onClick={reset}>Reset</button>\r\n        <button className=\"btn\" onClick={skip}>Skip</button>\r\n      </div>\r\n\r\n      <details className=\"pomodoro__settings\">\n        <summary>Settings</summary>\r\n        <div className=\"grid2\">\r\n          <label>Focus (min)\r\n            <input type=\"number\" min={1}\r\n              value={settings.focusMin}\r\n              onChange={(e) => setSettings(s => ({...s, focusMin: +e.target.value || 1}))}/>\r\n          </label>\r\n          <label>Short break (min)\r\n            <input type=\"number\" min={1}\r\n              value={settings.shortMin}\r\n              onChange={(e) => setSettings(s => ({...s, shortMin: +e.target.value || 1}))}/>\r\n          </label>\r\n          <label>Long break (min)\r\n            <input type=\"number\" min={1}\r\n              value={settings.longMin}\r\n              onChange={(e) => setSettings(s => ({...s, longMin: +e.target.value || 1}))}/>\r\n          </label>\r\n          <label>Cycles before long\r\n            <input type=\"number\" min={1}\r\n              value={settings.cyclesBeforeLong}\r\n              onChange={(e) => setSettings(s => ({...s, cyclesBeforeLong: Math.max(1, +e.target.value || 1)}))}/>\r\n          </label>\r\n          <label className=\"rowFlex\">\r\n            <input type=\"checkbox\"\r\n              checked={settings.autoStartNext}\r\n              onChange={(e) => setSettings(s => ({...s, autoStartNext: e.target.checked}))}/>\r\n              Auto-start next\r\n          </label>\r\n          <div className=\"muted\">Completed in block: {cycle}</div>\r\n        </div>\r\n      </details>\n\n      {showBreakModal && (\n        <BreakSuggestions\n          closing={modalClosing}\n          onStartBreak={() => {\n            setModalClosing(true);\n            setTimeout(() => {\n              setShowBreakModal(false);\n              setModalClosing(false);\n              // start the prepared break\n              setMode(nextModeRef.current);\n              start(nextDurRef.current);\n            }, 180);\n          }}\n          onSkipBreak={() => {\n            setModalClosing(true);\n            setTimeout(() => {\n              setShowBreakModal(false);\n              setModalClosing(false);\n              // jump to next focus session immediately\n              const dur = settings.focusMin * 60_000;\n              setMode(\"focus\");\n              setRemaining(dur);\n              start(dur);\n            }, 180);\n          }}\n        />\n      )}\n    </div>\n  );\n};\r\n\r\nexport default PomodoroTimer;\r\n"],"mappings":"sHAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,OAAO,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CACnE,MAAO,CAAAC,gBAAgB,KAAM,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAYlD,KAAM,CAAAC,QAA0B,CAAG,CACjCC,QAAQ,CAAE,EAAE,CACZC,QAAQ,CAAE,CAAC,CACXC,OAAO,CAAE,EAAE,CACXC,gBAAgB,CAAE,CAAC,CACnBC,aAAa,CAAE,IACjB,CAAC,CAED,QAAS,CAAAC,MAAMA,CAACC,EAAU,CAAE,CAC1B,KAAM,CAAAC,CAAC,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAED,IAAI,CAACE,KAAK,CAACJ,EAAE,CAAG,IAAI,CAAC,CAAC,CAC5C,KAAM,CAAAK,CAAC,CAAGH,IAAI,CAACI,KAAK,CAACL,CAAC,CAAG,EAAE,CAAC,CAC5B,KAAM,CAAAM,CAAC,CAAGN,CAAC,CAAG,EAAE,CAChB,SAAAO,MAAA,CAAUC,MAAM,CAACJ,CAAC,CAAC,CAACK,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,MAAAF,MAAA,CAAIC,MAAM,CAACF,CAAC,CAAC,CAACG,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,EACpE,CAEA,qEACA,cAAe,CAAAC,SAASA,CAACC,KAAa,CAAEC,IAAY,CAAE,CACpD,GAAI,EAAE,cAAc,EAAI,CAAAC,MAAM,CAAC,CAAE,MAAO,MAAK,CAC7C;AACA,GAAIC,YAAY,CAACC,UAAU,GAAK,SAAS,CAAE,CACzC,GAAI,CAAE,KAAM,CAAAD,YAAY,CAACE,iBAAiB,CAAC,CAAC,CAAE,CAAE,MAAAC,OAAA,CAAM,CAAC,CACzD,CACA,GAAIH,YAAY,CAACC,UAAU,GAAK,SAAS,CAAE,CACzC,GAAI,CAAE,GAAI,CAAAD,YAAY,CAACH,KAAK,CAAE,CAAEC,IAAI,CAAEM,GAAG,CAAE,UAAW,CAAC,CAAC,CAAE,MAAO,KAAI,CAAE,CAAE,MAAAC,QAAA,CAAM,CAAC,CAClF,CACA,MAAO,MAAK,CACd,CAEA;AACA,QAAS,CAAAC,SAASA,CAACC,QAAyD,CAAE,CAC5E,KAAM,CAAAC,CAAC,CAAGD,QAAQ,CAACE,OAAO,CAC1B,GAAID,CAAC,CAAE,CACLA,CAAC,CAACE,WAAW,CAAG,CAAC,CACjBF,CAAC,CAACG,MAAM,CAAG,CAAC,CACZH,CAAC,CAACI,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,IAAM,CACnB;AACA,GAAI,CACF,KAAM,CAAAC,GAAG,CAAIf,MAAM,CAASgB,YAAY,EAAKhB,MAAM,CAASiB,kBAAkB,CAC9E,KAAM,CAAAC,GAAG,CAAG,GAAI,CAAAH,GAAG,CAAC,CAAC,CACrB,KAAM,CAAAI,GAAG,CAAGD,GAAG,CAACE,gBAAgB,CAAC,CAAC,CAClC,KAAM,CAAAC,IAAI,CAAGH,GAAG,CAACI,UAAU,CAAC,CAAC,CAC7BH,GAAG,CAACI,IAAI,CAAG,MAAM,CAAEJ,GAAG,CAACK,SAAS,CAACC,KAAK,CAAG,GAAG,CAC5CN,GAAG,CAACO,OAAO,CAACL,IAAI,CAAC,CAAEA,IAAI,CAACK,OAAO,CAACR,GAAG,CAACS,WAAW,CAAC,CAChDN,IAAI,CAACA,IAAI,CAACO,cAAc,CAAC,KAAK,CAAEV,GAAG,CAACP,WAAW,CAAC,CAChDU,IAAI,CAACA,IAAI,CAACQ,4BAA4B,CAAC,GAAG,CAAEX,GAAG,CAACP,WAAW,CAAG,IAAI,CAAC,CACnEQ,GAAG,CAACW,KAAK,CAAC,CAAC,CACXC,UAAU,CAAC,IAAM,CACfV,IAAI,CAACA,IAAI,CAACQ,4BAA4B,CAAC,MAAM,CAAEX,GAAG,CAACP,WAAW,CAAG,IAAI,CAAC,CACtEQ,GAAG,CAACa,IAAI,CAACd,GAAG,CAACP,WAAW,CAAG,IAAI,CAAC,CAClC,CAAC,CAAE,GAAG,CAAC,CACT,CAAE,MAAAsB,QAAA,CAAM,CAAC,CACX,CAAC,CAAC,CACJ,CACF,CACA,QAAS,CAAAC,OAAOA,CAAA,CAAG,CACjB,GAAI,SAAS,EAAI,CAAAC,SAAS,CAAE,CAC1B,GAAI,CAAEA,SAAS,CAACD,OAAO,CAAC,CAAC,GAAG,CAAE,GAAG,CAAE,GAAG,CAAC,CAAC,CAAE,CAAE,MAAAE,QAAA,CAAM,CAAC,CACrD,CACF,CACA;AACA,QAAS,CAAAC,eAAeA,CAACC,KAAqC,CAAEC,MAA6C,CAAE,CAC7G,GAAIA,MAAM,CAAC7B,OAAO,CAAE,OACpB4B,KAAK,CAAC5B,OAAO,CAAG8B,QAAQ,CAAC1C,KAAK,CAC9B,GAAI,CAAA2C,EAAE,CAAG,KAAK,CACdF,MAAM,CAAC7B,OAAO,CAAGV,MAAM,CAAC0C,WAAW,CAAC,IAAM,CACxCD,EAAE,CAAG,CAACA,EAAE,CACRD,QAAQ,CAAC1C,KAAK,CAAG2C,EAAE,CAAG,kBAAkB,CAAGH,KAAK,CAAC5B,OAAO,CAC1D,CAAC,CAAE,GAAG,CAAsB,CAC9B,CACA,QAAS,CAAAiC,cAAcA,CAACL,KAAqC,CAAEC,MAA6C,CAAE,CAC5G,GAAIA,MAAM,CAAC7B,OAAO,CAAE,CAClBV,MAAM,CAAC4C,aAAa,CAACL,MAAM,CAAC7B,OAAO,CAAC,CACpC6B,MAAM,CAAC7B,OAAO,CAAG,IAAI,CACrB8B,QAAQ,CAAC1C,KAAK,CAAGwC,KAAK,CAAC5B,OAAO,EAAI8B,QAAQ,CAAC1C,KAAK,CAClD,CACF,CAQA,KAAM,CAAA+C,aAA8B,CAAGC,IAAA,EAA2D,IAA1D,CAAEC,eAAe,CAAEC,eAAe,CAAEC,eAAgB,CAAC,CAAAH,IAAA,CAC3F,KAAM,CAACI,QAAQ,CAAEC,WAAW,CAAC,CAAG9E,QAAQ,CAAmB,IAAM,CAC/D,GAAI,CACF,KAAM,CAAA+E,GAAG,CAAGC,YAAY,CAACC,OAAO,CAAC,mBAAmB,CAAC,CACrD,MAAO,CAAAF,GAAG,CAAAG,aAAA,CAAAA,aAAA,IAAQ5E,QAAQ,EAAK6E,IAAI,CAACC,KAAK,CAACL,GAAG,CAAC,EAAKzE,QAAQ,CAC7D,CAAE,MAAA+E,QAAA,CAAM,CACN,MAAO,CAAA/E,QAAQ,CACjB,CACF,CAAC,CAAC,CAEF;AACA,KAAM,CAACgF,IAAI,CAAEC,OAAO,CAAC,CAAGvF,QAAQ,CAAO,OAAO,CAAC,CAC/C,KAAM,CAACwF,OAAO,CAAEC,UAAU,CAAC,CAAGzF,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAC0F,KAAK,CAAEC,QAAQ,CAAC,CAAG3F,QAAQ,CAAgB,IAAI,CAAC,CACvD,KAAM,CAAC4F,SAAS,CAAEC,YAAY,CAAC,CAAG7F,QAAQ,CAAS6E,QAAQ,CAACtE,QAAQ,CAAG,KAAM,CAAC,CAC9E,KAAM,CAACuF,KAAK,CAAEC,QAAQ,CAAC,CAAG/F,QAAQ,CAAS,CAAC,CAAC,CAAE;AAC/C,KAAM,CAACgG,cAAc,CAAEC,iBAAiB,CAAC,CAAGjG,QAAQ,CAAU,KAAK,CAAC,CACpE,KAAM,CAACkG,YAAY,CAAEC,eAAe,CAAC,CAAGnG,QAAQ,CAAU,KAAK,CAAC,CAChE,KAAM,CAAAoG,WAAW,CAAGrG,MAAM,CAAO,OAAO,CAAC,CACzC,KAAM,CAAAsG,UAAU,CAAGtG,MAAM,CAAS8E,QAAQ,CAACrE,QAAQ,CAAG,KAAM,CAAC,CAE7D;AACA,KAAM,CAAC8F,IAAI,CAAEC,OAAO,CAAC,CAAGvG,QAAQ,CAAyC,SAAS,CAAC,CAEnF;AACA,KAAM,CAAAmC,QAAQ,CAAGpC,MAAM,CAA0B,IAAI,CAAC,CACtD,KAAM,CAAAyG,gBAAgB,CAAGzG,MAAM,CAASoE,QAAQ,CAAC1C,KAAK,CAAC,CACvD,KAAM,CAAAgF,UAAU,CAAG1G,MAAM,CAAgB,IAAI,CAAC,CAE9C;AACAF,SAAS,CAAC,IAAM,CACdmF,YAAY,CAAC0B,OAAO,CAAC,mBAAmB,CAAEvB,IAAI,CAACwB,SAAS,CAAC9B,QAAQ,CAAC,CAAC,CACrE,CAAC,CAAE,CAACA,QAAQ,CAAC,CAAC,CAEd;AACAhF,SAAS,CAAC,IAAM,CACd,GAAI,EAAE,cAAc,EAAI,CAAA8B,MAAM,CAAC,CAAE4E,OAAO,CAAC,aAAa,CAAC,CAAC,IACnD,CAAAA,OAAO,CAAC3E,YAAY,CAACC,UAAU,CAAC,CAErC;AACA,GAAI,CACF,GAAIM,QAAQ,CAACE,OAAO,CAAE,CACpBF,QAAQ,CAACE,OAAO,CAACuE,GAAG,CAClB,4FAA4F,CAChG,CACF,CAAE,MAAAC,QAAA,CAAM,CAAC,CACX,CAAC,CAAE,EAAE,CAAC,CAEN;AACA,KAAM,CAAAC,UAAU,CAAGhH,OAAO,CAAC,IAAM,CAC/B,GAAIwF,IAAI,GAAK,OAAO,CAAE,MAAO,CAAAT,QAAQ,CAACtE,QAAQ,CAAG,KAAM,CACvD,GAAI+E,IAAI,GAAK,OAAO,CAAE,MAAO,CAAAT,QAAQ,CAACrE,QAAQ,CAAG,KAAM,CACvD,MAAO,CAAAqE,QAAQ,CAACpE,OAAO,CAAG,KAAM,CAClC,CAAC,CAAE,CAAC6E,IAAI,CAAET,QAAQ,CAAC,CAAC,CAEpB;AACAhF,SAAS,CAAC,IAAM,CACd,GAAI,CAAC2F,OAAO,CAAEK,YAAY,CAACiB,UAAU,CAAC,CACtC;AACF,CAAC,CAAE,CAACA,UAAU,CAAC,CAAC,CAEhB;AACAjH,SAAS,CAAC,IAAM,CACd,GAAI,CAAC2F,OAAO,EAAIE,KAAK,EAAI,IAAI,CAAE,OAE/B,KAAM,CAAAqB,EAAE,CAAGpF,MAAM,CAAC0C,WAAW,CAAC,IAAM,CAClC,KAAM,CAAA2C,GAAG,CAAGC,IAAI,CAACD,GAAG,CAAC,CAAC,CACtB,KAAM,CAAAE,IAAI,CAAGxB,KAAK,CAAGsB,GAAG,CACxBnB,YAAY,CAACqB,IAAI,CAAC,CAClB,GAAIA,IAAI,EAAI,CAAC,CAAE,CACbvF,MAAM,CAAC4C,aAAa,CAACwC,EAAE,CAAC,CACxBtB,UAAU,CAAC,KAAK,CAAC,CACjBI,YAAY,CAAC,CAAC,CAAC,CAEf;AACA,CAAC,SAAY,CACX,GAAIP,IAAI,GAAK,OAAO,CAAE,CACpB;AACA,KAAM,CAAA7D,KAAK,CAAG,kBAAkB,CAChC,KAAM,CAAAC,IAAI,CAAGgD,eAAe,UAAArD,MAAA,CAAYqD,eAAe,EAAK,eAAe,CAC3E,KAAM,CAAAlD,SAAS,CAACC,KAAK,CAAEC,IAAI,CAAC,CAE5B;AACAQ,SAAS,CAACC,QAAQ,CAAC,CACnB0B,OAAO,CAAC,CAAC,CACTG,eAAe,CAACwC,gBAAgB,CAAEC,UAAU,CAAC,CAC7C;AACA9E,MAAM,CAAC+B,UAAU,CAAC,IAAMY,cAAc,CAACkC,gBAAgB,CAAEC,UAAU,CAAC,CAAE,KAAM,CAAC,CAE7E;AACA9B,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAG,CAAC,CAEnB;AACA,KAAM,CAAAwC,QAAQ,CACZ,CAACrB,KAAK,CAAG,CAAC,EAAIjB,QAAQ,CAACnE,gBAAgB,GAAK,CAAC,CAAG,MAAM,CAAG,OAAO,CAClEqF,QAAQ,CAAEqB,CAAC,EAAKA,CAAC,CAAG,CAAC,CAAC,CACtB7B,OAAO,CAAC4B,QAAQ,CAAC,CAEjB;AACA,KAAM,CAAAE,OAAO,CAAG,CAACF,QAAQ,GAAK,MAAM,CAAGtC,QAAQ,CAACpE,OAAO,CAAGoE,QAAQ,CAACrE,QAAQ,EAAI,KAAM,CACrFqF,YAAY,CAACwB,OAAO,CAAC,CACrBjB,WAAW,CAAC/D,OAAO,CAAG8E,QAAQ,CAC9Bd,UAAU,CAAChE,OAAO,CAAGgF,OAAO,CAC5BlB,eAAe,CAAC,KAAK,CAAC,CACtBF,iBAAiB,CAAC,IAAI,CAAC,CACzB,CAAC,IAAM,CACL;AACA,KAAM,CAAAxE,KAAK,CAAG6D,IAAI,GAAK,OAAO,CAAG,oBAAoB,CAAG,oBAAoB,CAC5E,KAAM,CAAA9D,SAAS,CAACC,KAAK,CAAE,sBAAsB,CAAC,CAC9CS,SAAS,CAACC,QAAQ,CAAC,CACnB0B,OAAO,CAAC,CAAC,CACTG,eAAe,CAACwC,gBAAgB,CAAEC,UAAU,CAAC,CAC7C9E,MAAM,CAAC+B,UAAU,CAAC,IAAMY,cAAc,CAACkC,gBAAgB,CAAEC,UAAU,CAAC,CAAE,KAAM,CAAC,CAE7ElB,OAAO,CAAC,OAAO,CAAC,CAChB,KAAM,CAAA8B,OAAO,CAAGxC,QAAQ,CAACtE,QAAQ,CAAG,KAAM,CAC1CsF,YAAY,CAACwB,OAAO,CAAC,CACrB,GAAIxC,QAAQ,CAAClE,aAAa,CAAE8C,KAAK,CAAC4D,OAAO,CAAC,CAC5C,CACF,CAAC,EAAE,CAAC,CACN,CACF,CAAC,CAAE,GAAG,CAAC,CAEP,MAAO,IAAM1F,MAAM,CAAC4C,aAAa,CAACwC,EAAE,CAAC,CACrC;AACF,CAAC,CAAE,CAACvB,OAAO,CAAEE,KAAK,CAAEJ,IAAI,CAAET,QAAQ,CAAEiB,KAAK,CAAEpB,eAAe,CAAC,CAAC,CAE5D,KAAM,CAAAjB,KAAK,CAAI6D,GAAY,EAAK,CAC9B;AACA,GAAI,cAAc,EAAI,CAAA3F,MAAM,EAAIC,YAAY,CAACC,UAAU,GAAK,SAAS,CAAE,CACrED,YAAY,CAACE,iBAAiB,CAAC,CAAC,CAACyF,IAAI,CAAEC,CAAC,EAAKjB,OAAO,CAACiB,CAAC,CAAC,CAAC,CAC1D,CACAlD,cAAc,CAACkC,gBAAgB,CAAEC,UAAU,CAAC,CAAE;AAC9C,KAAM,CAAAgB,QAAQ,CAAI,MAAO,CAAAH,GAAG,GAAK,QAAQ,CAAGA,GAAG,CAAGvG,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE4E,SAAS,CAAE,CACzE,KAAM,CAAA8B,MAAM,CAAGD,QAAQ,CAAG,CAAC,CAAGA,QAAQ,CAAGX,UAAU,CACnDnB,QAAQ,CAACsB,IAAI,CAACD,GAAG,CAAC,CAAC,CAAGU,MAAM,CAAC,CAC7BjC,UAAU,CAAC,IAAI,CAAC,CAChBb,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAG,IAAI,CAAC,CACvB;AACApD,SAAS,CACP8D,IAAI,GAAK,OAAO,CAAG,eAAe,CAAGA,IAAI,GAAK,OAAO,CAAG,qBAAqB,CAAG,oBAAoB,CACpGZ,eAAe,UAAArD,MAAA,CAAYqD,eAAe,EAAK,EACjD,CAAC,CACH,CAAC,CACD,KAAM,CAAAiD,KAAK,CAAGA,CAAA,GAAMlC,UAAU,CAAC,KAAK,CAAC,CACrC5F,SAAS,CAAC,IAAM,CAAE+E,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAGY,OAAO,CAAC,CAAE,CAAC,CAAE,CAACA,OAAO,CAAEZ,eAAe,CAAC,CAAC,CAC5E,KAAM,CAAAgD,KAAK,CAAGA,CAAA,GAAM,CAClBnC,UAAU,CAAC,KAAK,CAAC,CACjBE,QAAQ,CAAC,IAAI,CAAC,CACdE,YAAY,CAACiB,UAAU,CAAC,CACxBxC,cAAc,CAACkC,gBAAgB,CAAEC,UAAU,CAAC,CAC5C7B,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAG,KAAK,CAAC,CAC1B,CAAC,CACD,KAAM,CAAAiD,IAAI,CAAGA,CAAA,GAAM,CACjB;AACApC,UAAU,CAAC,KAAK,CAAC,CACjBI,YAAY,CAAC,CAAC,CAAC,CACfvB,cAAc,CAACkC,gBAAgB,CAAEC,UAAU,CAAC,CAE5C,GAAInB,IAAI,GAAK,OAAO,CAAE,CACpBS,QAAQ,CAAEqB,CAAC,EAAKA,CAAC,CAAG,CAAC,CAAC,CACtBzC,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAG,CAAC,CACnB,KAAM,CAAAmD,IAAI,CAAG,CAAChC,KAAK,CAAG,CAAC,EAAIjB,QAAQ,CAACnE,gBAAgB,GAAK,CAAC,CAAG,MAAM,CAAG,OAAO,CAC7E6E,OAAO,CAACuC,IAAI,CAAC,CACf,CAAC,IAAM,CACLvC,OAAO,CAAC,OAAO,CAAC,CAClB,CACA7B,UAAU,CAAC,IAAM,CACf,GAAImB,QAAQ,CAAClE,aAAa,CAAE8C,KAAK,CAAC,CAAC,CAAC,IAC/B,CAAAmE,KAAK,CAAC,CAAC,CACd,CAAC,CAAE,CAAC,CAAC,CACP,CAAC,CAED,KAAM,CAAA9F,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,EAAE,cAAc,EAAI,CAAAH,MAAM,CAAC,CAAE,MAAO,CAAAoG,KAAK,CAAC,8BAA8B,CAAC,CAC7E,GAAInG,YAAY,CAACC,UAAU,GAAK,QAAQ,CAAE,CACxC0E,OAAO,CAAC,QAAQ,CAAC,CACjBwB,KAAK,CACH,CACE,0CAA0C,CAC1C,4FAA4F,CAC7F,CAACC,IAAI,CAAC,IAAI,CACb,CAAC,CACD,OACF,CACA,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAArG,YAAY,CAACE,iBAAiB,CAAC,CAAC,CAClDyE,OAAO,CAAC0B,GAAG,CAAC,CACZ,GAAIA,GAAG,GAAK,SAAS,CAAEF,KAAK,CAAC,uBAAuB,CAAC,CAAC,IACjD,CACH;AACA,KAAM,CAAAvG,SAAS,CAAC,uBAAuB,CAAE,qCAAqC,CAAC,CACjF,CACF,CAAE,MAAA0G,QAAA,CAAM,CACNH,KAAK,CAAC,kCAAkC,CAAC,CAC3C,CACF,CAAC,CAED,mBACE1H,KAAA,QAAK8H,SAAS,CAAC,UAAU,CAAAC,QAAA,eAEvBjI,IAAA,UAAOkI,GAAG,CAAElG,QAAS,CAACmG,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAE,CAAC,cAEpDlI,KAAA,QAAK8H,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BjI,IAAA,QAAKgI,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAC5B,CAAC,OAAO,CAAE,OAAO,CAAE,MAAM,CAAC,CAAYI,GAAG,CAAEtH,CAAC,eAC5Cf,IAAA,WAEEgI,SAAS,SAAA9G,MAAA,CAAUiE,IAAI,GAAKpE,CAAC,CAAG,QAAQ,CAAG,EAAE,CAAG,CAChDuH,OAAO,CAAEA,CAAA,GAAM,CACblD,OAAO,CAACrE,CAAC,CAAC,CACVuE,UAAU,CAAC,KAAK,CAAC,CACjBE,QAAQ,CAAC,IAAI,CAAC,CACdrB,cAAc,CAACkC,gBAAgB,CAAEC,UAAU,CAAC,CAC9C,CAAE,CAAA2B,QAAA,CAEDlH,CAAC,GAAK,OAAO,CAAG,OAAO,CAAGA,CAAC,GAAK,OAAO,CAAG,OAAO,CAAG,MAAM,EATtDA,CAUC,CACT,CAAC,CACC,CAAC,cAGNf,IAAA,WAAQgI,SAAS,CAAC,MAAM,CAACM,OAAO,CAAE3G,iBAAkB,CAACL,KAAK,CAAC,sBAAsB,CAACiH,QAAQ,CAAEpC,IAAI,GAAK,aAAc,CAAA8B,QAAA,CAChH9B,IAAI,GAAK,SAAS,CAAG,IAAI,CAAG,IAAI,CAC3B,CAAC,EACN,CAAC,CAEL5B,eAAe,eACdrE,KAAA,QAAK8H,SAAS,CAAC,gBAAgB,CAAC1G,KAAK,CAAC,aAAa,CAAA2G,QAAA,EAAC,eAC/C,CAAC1D,eAAe,EAChB,CACN,cAEDrE,KAAA,QAAK8H,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BjI,IAAA,QAAKgI,SAAS,CAAC,WAAW,CAACQ,KAAK,CAAC,KAAK,CAACC,MAAM,CAAC,KAAK,CAACC,OAAO,CAAC,aAAa,CAAC,kBAAW,CAAAT,QAAA,CAClF,CAAC,IAAM,CACN,KAAM,CAAAhH,CAAC,CAAG,EAAE,CAAE,KAAM,CAAA0H,EAAE,CAAG,EAAE,CAAE,KAAM,CAAAC,EAAE,CAAG,EAAE,CAAE,KAAM,CAAA3B,CAAC,CAAG,CAAC,CAAGrG,IAAI,CAACiI,EAAE,CAAG5H,CAAC,CACrE,KAAM,CAAA6H,KAAK,CAAGlI,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE8F,UAAU,CAAC,CACrC,KAAM,CAAAoC,IAAI,CAAGnI,IAAI,CAACC,GAAG,CAAC,CAAC,CAAED,IAAI,CAACoI,GAAG,CAAC,CAAC,CAAEvD,SAAS,CAAGqD,KAAK,CAAC,CAAC,CACxD,KAAM,CAAAG,GAAG,CAAGhC,CAAC,CAAG8B,IAAI,CACpB,mBACE7I,KAAA,MAAA+H,QAAA,eACEjI,IAAA,WAAQgI,SAAS,CAAC,SAAS,CAACW,EAAE,CAAEA,EAAG,CAACC,EAAE,CAAEA,EAAG,CAAC3H,CAAC,CAAEA,CAAE,CAAE,CAAC,cACpDjB,IAAA,WAAQgI,SAAS,CAAC,SAAS,CAACW,EAAE,CAAEA,EAAG,CAACC,EAAE,CAAEA,EAAG,CAAC3H,CAAC,CAAEA,CAAE,CAC/CkH,KAAK,CAAE,CAAEe,eAAe,IAAAhI,MAAA,CAAK+F,CAAC,MAAI,CAAEkC,gBAAgB,IAAAjI,MAAA,CAAK+H,GAAG,MAAK,CAAE,CAAE,CAAC,EACvE,CAAC,CAER,CAAC,EAAE,CAAC,CACD,CAAC,cACNjJ,IAAA,QAAKgI,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAExH,MAAM,CAACgF,SAAS,CAAC,CAAM,CAAC,EACjD,CAAC,cAENvF,KAAA,QAAK8H,SAAS,CAAC,oBAAoB,CAAAC,QAAA,EAChC,CAAC5C,OAAO,cACPrF,IAAA,WAAQgI,SAAS,CAAC,KAAK,CAACM,OAAO,CAAEA,CAAA,GAAMhF,KAAK,CAAC,CAAE,CAAA2E,QAAA,CAAC,OAAK,CAAQ,CAAC,cAE9DjI,IAAA,WAAQgI,SAAS,CAAC,KAAK,CAACM,OAAO,CAAEd,KAAM,CAAAS,QAAA,CAAC,OAAK,CAAQ,CACtD,cACDjI,IAAA,WAAQgI,SAAS,CAAC,KAAK,CAACM,OAAO,CAAEb,KAAM,CAAAQ,QAAA,CAAC,OAAK,CAAQ,CAAC,cACtDjI,IAAA,WAAQgI,SAAS,CAAC,KAAK,CAACM,OAAO,CAAEZ,IAAK,CAAAO,QAAA,CAAC,MAAI,CAAQ,CAAC,EACjD,CAAC,cAEN/H,KAAA,YAAS8H,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACrCjI,IAAA,YAAAiI,QAAA,CAAS,UAAQ,CAAS,CAAC,cAC3B/H,KAAA,QAAK8H,SAAS,CAAC,OAAO,CAAAC,QAAA,eACpB/H,KAAA,UAAA+H,QAAA,EAAO,aACL,cAAAjI,IAAA,UAAO+C,IAAI,CAAC,QAAQ,CAACiG,GAAG,CAAE,CAAE,CAC1B/F,KAAK,CAAEyB,QAAQ,CAACtE,QAAS,CACzBgJ,QAAQ,CAAGC,CAAC,EAAK1E,WAAW,CAAChE,CAAC,EAAAoE,aAAA,CAAAA,aAAA,IAASpE,CAAC,MAAEP,QAAQ,CAAE,CAACiJ,CAAC,CAACC,MAAM,CAACrG,KAAK,EAAI,CAAC,EAAE,CAAE,CAAC,CAAC,EAC3E,CAAC,cACR/C,KAAA,UAAA+H,QAAA,EAAO,mBACL,cAAAjI,IAAA,UAAO+C,IAAI,CAAC,QAAQ,CAACiG,GAAG,CAAE,CAAE,CAC1B/F,KAAK,CAAEyB,QAAQ,CAACrE,QAAS,CACzB+I,QAAQ,CAAGC,CAAC,EAAK1E,WAAW,CAAChE,CAAC,EAAAoE,aAAA,CAAAA,aAAA,IAASpE,CAAC,MAAEN,QAAQ,CAAE,CAACgJ,CAAC,CAACC,MAAM,CAACrG,KAAK,EAAI,CAAC,EAAE,CAAE,CAAC,CAAC,EAC3E,CAAC,cACR/C,KAAA,UAAA+H,QAAA,EAAO,kBACL,cAAAjI,IAAA,UAAO+C,IAAI,CAAC,QAAQ,CAACiG,GAAG,CAAE,CAAE,CAC1B/F,KAAK,CAAEyB,QAAQ,CAACpE,OAAQ,CACxB8I,QAAQ,CAAGC,CAAC,EAAK1E,WAAW,CAAChE,CAAC,EAAAoE,aAAA,CAAAA,aAAA,IAASpE,CAAC,MAAEL,OAAO,CAAE,CAAC+I,CAAC,CAACC,MAAM,CAACrG,KAAK,EAAI,CAAC,EAAE,CAAE,CAAC,CAAC,EAC1E,CAAC,cACR/C,KAAA,UAAA+H,QAAA,EAAO,oBACL,cAAAjI,IAAA,UAAO+C,IAAI,CAAC,QAAQ,CAACiG,GAAG,CAAE,CAAE,CAC1B/F,KAAK,CAAEyB,QAAQ,CAACnE,gBAAiB,CACjC6I,QAAQ,CAAGC,CAAC,EAAK1E,WAAW,CAAChE,CAAC,EAAAoE,aAAA,CAAAA,aAAA,IAASpE,CAAC,MAAEJ,gBAAgB,CAAEK,IAAI,CAACC,GAAG,CAAC,CAAC,CAAE,CAACwI,CAAC,CAACC,MAAM,CAACrG,KAAK,EAAI,CAAC,CAAC,EAAE,CAAE,CAAC,CAAC,EAChG,CAAC,cACR/C,KAAA,UAAO8H,SAAS,CAAC,SAAS,CAAAC,QAAA,eACxBjI,IAAA,UAAO+C,IAAI,CAAC,UAAU,CACpBwG,OAAO,CAAE7E,QAAQ,CAAClE,aAAc,CAChC4I,QAAQ,CAAGC,CAAC,EAAK1E,WAAW,CAAChE,CAAC,EAAAoE,aAAA,CAAAA,aAAA,IAASpE,CAAC,MAAEH,aAAa,CAAE6I,CAAC,CAACC,MAAM,CAACC,OAAO,EAAE,CAAE,CAAC,CAAC,kBAEnF,EAAO,CAAC,cACRrJ,KAAA,QAAK8H,SAAS,CAAC,OAAO,CAAAC,QAAA,EAAC,sBAAoB,CAACtC,KAAK,EAAM,CAAC,EACrD,CAAC,EACC,CAAC,CAETE,cAAc,eACb7F,IAAA,CAACF,gBAAgB,EACf0J,OAAO,CAAEzD,YAAa,CACtB0D,YAAY,CAAEA,CAAA,GAAM,CAClBzD,eAAe,CAAC,IAAI,CAAC,CACrBzC,UAAU,CAAC,IAAM,CACfuC,iBAAiB,CAAC,KAAK,CAAC,CACxBE,eAAe,CAAC,KAAK,CAAC,CACtB;AACAZ,OAAO,CAACa,WAAW,CAAC/D,OAAO,CAAC,CAC5BoB,KAAK,CAAC4C,UAAU,CAAChE,OAAO,CAAC,CAC3B,CAAC,CAAE,GAAG,CAAC,CACT,CAAE,CACFwH,WAAW,CAAEA,CAAA,GAAM,CACjB1D,eAAe,CAAC,IAAI,CAAC,CACrBzC,UAAU,CAAC,IAAM,CACfuC,iBAAiB,CAAC,KAAK,CAAC,CACxBE,eAAe,CAAC,KAAK,CAAC,CACtB;AACA,KAAM,CAAAmB,GAAG,CAAGzC,QAAQ,CAACtE,QAAQ,CAAG,KAAM,CACtCgF,OAAO,CAAC,OAAO,CAAC,CAChBM,YAAY,CAACyB,GAAG,CAAC,CACjB7D,KAAK,CAAC6D,GAAG,CAAC,CACZ,CAAC,CAAE,GAAG,CAAC,CACT,CAAE,CACH,CACF,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAA9C,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}